---
phase: 29-tenant-scoped-analytics-mcp
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/lib/constants.ts
  - apps/web/components/skill-card.tsx
  - apps/web/components/skills-table-row.tsx
  - apps/web/components/my-leverage-view.tsx
  - apps/web/components/header-stats.tsx
  - apps/web/components/skill-detail.tsx
  - apps/web/components/leaderboard-table.tsx
  - apps/web/app/(protected)/page.tsx
  - apps/web/app/(protected)/users/[id]/page.tsx
  - apps/web/app/(protected)/profile/page.tsx
autonomous: true

must_haves:
  truths:
    - "FTE Years Saved uses 2,080 hours/year (40 hrs/wk * 52 wks) across all display locations"
    - "All 11 display locations use the shared FTE_HOURS_PER_YEAR constant or derived FTE_DAYS_PER_YEAR"
    - "No instances of / 8 / 365 or / 365 for FTE year calculations remain"
  artifacts:
    - path: "apps/web/lib/constants.ts"
      provides: "Centralized FTE constant"
      contains: "FTE_HOURS_PER_YEAR"
  key_links:
    - from: "apps/web/components/skill-card.tsx"
      to: "apps/web/lib/constants.ts"
      via: "import FTE constant"
      pattern: "FTE_HOURS_PER_YEAR|FTE_DAYS_PER_YEAR"
---

<objective>
Standardize the FTE Years Saved calculation to use 2,080 hours/year (USA FTE standard) by creating a shared constant and updating all 11 display locations.

Purpose: Correct FTE calculation from 2,920 hrs/yr (/ 8 / 365) to 2,080 hrs/yr (METRIC-01)
Output: Consistent FTE Years Saved values across the entire platform
</objective>

<execution_context>
@/home/dev/.claude/agents/gsd-planner.md
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@apps/web/components/skill-card.tsx
@apps/web/components/header-stats.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FTE constant and update all 11 display locations</name>
  <files>
    apps/web/lib/constants.ts
    apps/web/components/skill-card.tsx
    apps/web/components/skills-table-row.tsx
    apps/web/components/my-leverage-view.tsx
    apps/web/components/header-stats.tsx
    apps/web/components/skill-detail.tsx
    apps/web/components/leaderboard-table.tsx
    apps/web/app/(protected)/page.tsx
    apps/web/app/(protected)/users/[id]/page.tsx
    apps/web/app/(protected)/profile/page.tsx
  </files>
  <action>
**Create `apps/web/lib/constants.ts`:**
```typescript
/**
 * Standard USA FTE hours per year.
 * 40 hours/week * 52 weeks/year = 2,080 hours/year
 * Used for all "FTE Years Saved" calculations across the platform.
 */
export const FTE_HOURS_PER_YEAR = 2080;

/**
 * Standard USA FTE working days per year.
 * 2,080 hours / 8 hours per day = 260 working days/year
 * Used when converting "FTE days saved" (hours / 8) to years.
 */
export const FTE_DAYS_PER_YEAR = 260;
```

**Update all 11 display locations. Two patterns exist:**

Pattern A — "hours to years" (`/ 8 / 365` becomes `/ FTE_HOURS_PER_YEAR`):
1. `apps/web/components/skill-card.tsx` line 41: `(totalUses * hoursSaved) / 8 / 365` -> `(skill.totalUses * (skill.hoursSaved ?? 1)) / FTE_HOURS_PER_YEAR`
2. `apps/web/components/skills-table-row.tsx` line 91: same pattern -> `/ FTE_HOURS_PER_YEAR`
3. `apps/web/components/my-leverage-view.tsx` line 128: `totalHoursSaved / 8 / 365` -> `totalHoursSaved / FTE_HOURS_PER_YEAR`
4. `apps/web/components/my-leverage-view.tsx` line 186: `hoursSavedByOthers / 8 / 365` -> `hoursSavedByOthers / FTE_HOURS_PER_YEAR`
5. `apps/web/app/(protected)/users/[id]/page.tsx` line 121: `(totalUses * hoursSaved) / 8 / 365` -> `/ FTE_HOURS_PER_YEAR`

Pattern B — "FTE days to years" (`/ 365` becomes `/ FTE_DAYS_PER_YEAR` where the input is already hours/8):
6. `apps/web/components/header-stats.tsx` line 14: `totalDaysSaved / 365` -> `totalDaysSaved / FTE_DAYS_PER_YEAR`
7. `apps/web/components/skill-detail.tsx` line 106: `fteDaysSaved / 365` -> `fteDaysSaved / FTE_DAYS_PER_YEAR`
8. `apps/web/components/leaderboard-table.tsx` line 92: `fteDaysSaved / 365` -> `fteDaysSaved / FTE_DAYS_PER_YEAR`
9. `apps/web/app/(protected)/page.tsx` line 166: `totalFteDaysSaved / 365` -> `totalFteDaysSaved / FTE_DAYS_PER_YEAR`
10. `apps/web/app/(protected)/users/[id]/page.tsx` line 60: `fteDaysSaved / 365` -> `fteDaysSaved / FTE_DAYS_PER_YEAR`
11. `apps/web/app/(protected)/profile/page.tsx` line 45: `fteDaysSaved / 365` -> `fteDaysSaved / FTE_DAYS_PER_YEAR`

For each file, add the import at the top:
```typescript
import { FTE_HOURS_PER_YEAR } from "@/lib/constants";
// or
import { FTE_DAYS_PER_YEAR } from "@/lib/constants";
// or both, depending on which pattern the file uses
```

Read each file before modifying to get exact line numbers and context. The line numbers above are from research and may have shifted.
  </action>
  <verify>
Run `cd /home/dev/projects/relay && pnpm build 2>&1 | tail -5` to verify build passes.
Grep for old patterns: `grep -rn "/ 8 / 365\|/ 365" apps/web/components/ apps/web/app/\(protected\)/page.tsx apps/web/app/\(protected\)/users/ apps/web/app/\(protected\)/profile/` — should return zero FTE-related matches (note: some non-FTE uses of 365 in getStartDate are fine).
Grep for new constant usage: `grep -rn "FTE_HOURS_PER_YEAR\|FTE_DAYS_PER_YEAR" apps/web/` should show 11+ matches across components.
  </verify>
  <done>All 11 FTE display locations use FTE_HOURS_PER_YEAR (2080) or FTE_DAYS_PER_YEAR (260), zero instances of the old / 8 / 365 or incorrect / 365 patterns remain in display components</done>
</task>

</tasks>

<verification>
1. `cd /home/dev/projects/relay && pnpm build` passes with no errors
2. `grep -rn "/ 8 / 365" apps/web/` returns zero matches
3. `grep -rn "FTE_HOURS_PER_YEAR\|FTE_DAYS_PER_YEAR" apps/web/` returns 11+ matches
4. `cat apps/web/lib/constants.ts` shows FTE_HOURS_PER_YEAR = 2080 and FTE_DAYS_PER_YEAR = 260
</verification>

<success_criteria>
- FTE_HOURS_PER_YEAR = 2080 constant exists in apps/web/lib/constants.ts
- FTE_DAYS_PER_YEAR = 260 constant exists in apps/web/lib/constants.ts
- All 11 display locations import and use the constant
- No / 8 / 365 patterns remain in display components
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/29-tenant-scoped-analytics-mcp/29-03-SUMMARY.md`
</output>
