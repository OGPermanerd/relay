---
phase: 54-deployment-plan
plan: 02
type: execute
wave: 2
depends_on: ["54-01"]
files_modified:
  - apps/web/components/recommendations-section.tsx
  - apps/web/tests/e2e/deployment-plan.spec.ts
autonomous: true

must_haves:
  truths:
    - "RecommendationsSection shows a 'View Full Deployment Plan' link when recommendations exist"
    - "E2E test verifies deployment plan page loads and displays expected sections"
  artifacts:
    - path: "apps/web/components/recommendations-section.tsx"
      provides: "Link to deployment plan sub-page"
      contains: "deployment-plan"
    - path: "apps/web/tests/e2e/deployment-plan.spec.ts"
      provides: "Playwright E2E test for deployment plan page"
      contains: "deployment-plan"
  key_links:
    - from: "recommendations-section.tsx"
      to: "/my-leverage/deployment-plan"
      via: "Next.js Link component"
      pattern: "deployment-plan"
---

<objective>
Add "View Full Deployment Plan" navigation from the recommendations section and create E2E test coverage.

Purpose: Connect the existing recommendations UI to the new deployment plan page and verify the full flow works.
Output: Modified recommendations-section.tsx with link, new E2E test file.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/web/components/recommendations-section.tsx
@apps/web/tests/e2e/home.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add "View Full Deployment Plan" link to RecommendationsSection</name>
  <files>apps/web/components/recommendations-section.tsx</files>
  <action>
Modify the existing `RecommendationsSection` component to add a link to the deployment plan page below the recommendations grid.

1. Add `import Link from "next/link";` at the top (next to existing imports)

2. In the success state (after the `<div className="grid grid-cols-1 gap-4 lg:grid-cols-2">` block with recommendation cards), add a new div below the grid:

```tsx
<div className="mt-6 text-center">
  <Link
    href="/my-leverage/deployment-plan"
    className="inline-flex items-center gap-1 text-sm font-medium text-blue-600 hover:text-blue-700 hover:underline"
  >
    View Full Deployment Plan &rarr;
  </Link>
</div>
```

This link only renders in the success state (when `recommendations.length > 0`), so it won't appear in loading, error, or empty states.

Do NOT change any other part of the component -- loading, error, and empty states remain unchanged.
  </action>
  <verify>`cd /home/dev/projects/relay && npx tsc --noEmit --project apps/web/tsconfig.json 2>&1 | head -30` passes.</verify>
  <done>RecommendationsSection displays "View Full Deployment Plan" link below recommendation cards when recommendations exist.</done>
</task>

<task type="auto">
  <name>Task 2: Create E2E test for deployment plan page</name>
  <files>apps/web/tests/e2e/deployment-plan.spec.ts</files>
  <action>
Create a Playwright E2E test file for the deployment plan page. Follow patterns from existing tests like `home.spec.ts`.

```typescript
import { test, expect } from "@playwright/test";

test.describe("Deployment Plan", () => {
  test("page loads and shows header", async ({ page }) => {
    await page.goto("/my-leverage/deployment-plan");
    // Should redirect to login or show content (auth-dependent)
    // If authenticated, check for page title
    const heading = page.locator("h1");
    await expect(heading).toBeVisible({ timeout: 10000 });
  });

  test("shows empty state or deployment plan content", async ({ page }) => {
    await page.goto("/my-leverage/deployment-plan");
    // Page should show either empty state or plan content
    const pageContent = page.locator("main, [class*='max-w']").first();
    await expect(pageContent).toBeVisible({ timeout: 10000 });
    // Verify back link exists
    const backLink = page.locator('a[href="/my-leverage"]');
    await expect(backLink).toBeVisible();
  });

  test("back link navigates to my-leverage", async ({ page }) => {
    await page.goto("/my-leverage/deployment-plan");
    const backLink = page.locator('a[href="/my-leverage"]');
    await expect(backLink).toBeVisible({ timeout: 10000 });
    await backLink.click();
    await expect(page).toHaveURL(/\/my-leverage$/);
  });
});
```

The tests use the auth setup project from `playwright.config.ts` which provides a logged-in session. Tests are intentionally lightweight: verify the page loads, renders content (empty state or dashboard depending on user data), and navigation works. We do NOT test chart rendering in E2E (Recharts renders to SVG which is brittle to assert on).
  </action>
  <verify>Run: `cd /home/dev/projects/relay/apps/web && npx playwright test tests/e2e/deployment-plan.spec.ts --reporter=list`</verify>
  <done>E2E tests pass: page loads, shows content, and back link navigates correctly.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- no errors
2. Playwright E2E tests pass for deployment-plan.spec.ts
3. Visit `/my-leverage` -- if recommendations exist, "View Full Deployment Plan" link appears below them
4. Click link navigates to `/my-leverage/deployment-plan`
</verification>

<success_criteria>
- RecommendationsSection shows "View Full Deployment Plan" link when recommendations are present
- Link correctly navigates to /my-leverage/deployment-plan
- E2E tests confirm page loads and basic navigation works
- No regressions in existing recommendation or my-leverage page functionality
</success_criteria>

<output>
After completion, create `.planning/phases/54-deployment-plan/54-02-SUMMARY.md`
</output>
