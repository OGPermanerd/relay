---
phase: 54-deployment-plan
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/components/adoption-roadmap-chart.tsx
  - apps/web/app/(protected)/my-leverage/deployment-plan/page.tsx
  - apps/web/app/(protected)/my-leverage/deployment-plan/deployment-plan-dashboard.tsx
autonomous: true

must_haves:
  truths:
    - "User sees a ranked skill adoption list ordered by projected weekly savings (highest ROI first)"
    - "Each list entry shows skill name, matched email category, and projected hours saved per week"
    - "Cumulative FTE Days Saved AreaChart displays savings accumulating over a 12-week horizon"
    - "First skill in the list has a 'Start Here' callout with clear reasoning"
  artifacts:
    - path: "apps/web/components/adoption-roadmap-chart.tsx"
      provides: "Recharts AreaChart for cumulative FTE Days Saved projection"
      contains: "AreaChart"
    - path: "apps/web/app/(protected)/my-leverage/deployment-plan/page.tsx"
      provides: "Server component page that fetches recommendations"
      contains: "getRecommendations"
    - path: "apps/web/app/(protected)/my-leverage/deployment-plan/deployment-plan-dashboard.tsx"
      provides: "Client dashboard with ranked list + chart + start-here guide"
      contains: "use client"
  key_links:
    - from: "deployment-plan/page.tsx"
      to: "getRecommendations server action"
      via: "direct import and await"
      pattern: "getRecommendations"
    - from: "deployment-plan/page.tsx"
      to: "deployment-plan-dashboard.tsx"
      via: "props pass of SkillRecommendation[]"
      pattern: "DeploymentPlanDashboard"
    - from: "deployment-plan-dashboard.tsx"
      to: "adoption-roadmap-chart.tsx"
      via: "component import with computed projection data"
      pattern: "AdoptionRoadmapChart"
---

<objective>
Create the Deployment Plan sub-page with a ranked skill adoption list, cumulative FTE Days Saved projection chart, and "start here" adoption guide.

Purpose: Transform flat recommendations into an actionable adoption roadmap showing which skill to adopt first and the compound value of sequential adoption.
Output: Three new files -- AreaChart component, server page, client dashboard.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/web/components/usage-area-chart.tsx
@apps/web/app/(protected)/my-leverage/email-diagnostic/page.tsx
@apps/web/lib/skill-recommendations.ts
@apps/web/app/actions/recommendations.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AdoptionRoadmapChart component</name>
  <files>apps/web/components/adoption-roadmap-chart.tsx</files>
  <action>
Create a "use client" Recharts AreaChart component following the exact pattern from `usage-area-chart.tsx`.

Interface `ProjectionPoint`: `{ week: number; cumulativeFteDays: number; label: string; skillAdopted?: string }`.

Props: `{ data: ProjectionPoint[]; height?: number }` with height default 300.

Empty state: If `data.length === 0`, render the dashed-border empty placeholder matching `usage-area-chart.tsx` pattern with message "No projection data available".

Chart config:
- `<div style={{ height }} className="w-full">` wrapper for explicit height (ResponsiveContainer needs it)
- `ResponsiveContainer width="100%" height="100%"`
- `AreaChart` with `margin={{ top: 10, right: 10, left: 0, bottom: 0 }}`
- `CartesianGrid strokeDasharray="3 3" className="stroke-gray-200"`
- `XAxis dataKey="label"` with `tick={{ fontSize: 12 }}`
- `YAxis` with `tick={{ fontSize: 12 }}`, `tickFormatter={(v: number) => v.toFixed(1)}`
- `Tooltip` with `formatter` returning `[Number(value).toFixed(1) + " FTE days", "Cumulative Savings"]`, `contentStyle={{ borderRadius: "0.5rem", border: "1px solid #e5e7eb" }}`
- `Area type="monotone" dataKey="cumulativeFteDays" stroke="#10b981" fill="#10b981" fillOpacity={0.1} strokeWidth={2}` (green color to differentiate from blue usage charts)

Export the `ProjectionPoint` interface for use by the dashboard.
  </action>
  <verify>TypeScript compiles: `cd /home/dev/projects/relay && npx tsc --noEmit --project apps/web/tsconfig.json 2>&1 | head -30`</verify>
  <done>AdoptionRoadmapChart renders a green AreaChart of cumulative FTE Days Saved with proper empty state handling.</done>
</task>

<task type="auto">
  <name>Task 2: Create deployment plan server page</name>
  <files>apps/web/app/(protected)/my-leverage/deployment-plan/page.tsx</files>
  <action>
Create the server component page following the exact pattern from `email-diagnostic/page.tsx`.

1. `export const metadata = { title: "Deployment Plan | EverySkill" };`
2. Auth check: `const session = await auth(); if (!session?.user?.id) redirect("/login");`
3. Fetch recommendations: `const result = await getRecommendations();`
4. Layout structure:
   - Back link to `/my-leverage` (same pattern: `text-sm font-medium text-blue-600`)
   - Page header: h1 "Skill Deployment Plan", subtitle "Your prioritized adoption roadmap with projected time savings"
   - If result has recommendations and length > 0: render `<DeploymentPlanDashboard recommendations={result.recommendations} />`
   - Else: empty state with dashed border, message "No skill recommendations yet. Run an email diagnostic scan to get personalized suggestions.", link button to `/my-leverage`

Imports: `Link` from next/link, `auth` from @/auth, `redirect` from next/navigation, `getRecommendations` from @/app/actions/recommendations, `DeploymentPlanDashboard` from ./deployment-plan-dashboard.
  </action>
  <verify>TypeScript compiles without errors for this file.</verify>
  <done>Server page fetches recommendations and renders the client dashboard or empty state.</done>
</task>

<task type="auto">
  <name>Task 3: Create DeploymentPlanDashboard client component</name>
  <files>apps/web/app/(protected)/my-leverage/deployment-plan/deployment-plan-dashboard.tsx</files>
  <action>
Create a "use client" component that receives `{ recommendations: SkillRecommendation[] }` as props.

**Computation function `computeCumulativeProjection`:**
- Takes `recommendations: SkillRecommendation[]`, `weeksToProject: number = 12`
- Sort by `projectedWeeklySavings` descending (highest ROI first)
- For each week 1-12: `skillsAdoptedByWeek = Math.min(Math.ceil(week / 2), sorted.length)` (1 new skill every 2 weeks)
- Weekly hours saved = sum of `projectedWeeklySavings` for adopted skills
- Convert to FTE days: `weeklyHoursSaved / 8`
- Accumulate: `cumulativeFteDays += fteDaysThisWeek`
- Round: `Math.round(cumulativeFteDays * 10) / 10`
- Returns `ProjectionPoint[]` with `{ week, cumulativeFteDays, label: "Week " + week }`

**Layout (3 sections):**

1. **Summary KPIs** (top row, flex/grid):
   - Total projected weekly savings: sum of all `projectedWeeklySavings`, formatted with `.toFixed(1)` + "hrs/week"
   - Total FTE days saved over 12 weeks: last point's `cumulativeFteDays`, formatted `.toFixed(1)` + " FTE days"
   - Number of skills in plan: `recommendations.length`
   - Style: 3-column grid with white cards, border, rounded-lg, p-4

2. **Cumulative FTE Projection Chart:**
   - Section heading "Cumulative FTE Days Saved"
   - Subtitle "Projected savings over 12 weeks with staggered skill adoption (1 new skill every 2 weeks)"
   - Render `<AdoptionRoadmapChart data={projectionData} height={320} />`

3. **Ranked Adoption List:**
   - Section heading "Adoption Roadmap"
   - Subtitle "Skills ranked by impact -- adopt in this order for maximum ROI"
   - Sort recommendations by `projectedWeeklySavings` DESC
   - Map each to a card with:
     - Step number badge: absolute positioned, `-left-3 -top-3`, blue circle (`bg-blue-600 text-white`), 8x8, bold text
     - Skill name as h3 (font-semibold text-gray-900)
     - `projectedWeeklySavings.toFixed(1)` + "hrs/week saved" badge (bg-green-100 text-green-800, rounded-full)
     - Matched categories as comma-joined text (text-sm text-gray-500)
     - `personalizedReason` paragraph (text-sm text-gray-700)
     - "View Skill" link to `/skills/${rec.slug}` (text-blue-600, hover underline)
     - For index === 0: green callout at top of card with border-l-4 border-green-400 bg-green-50 p-3, text "Start here -- biggest time savings"

Cards use: `relative rounded-lg border border-gray-200 bg-white p-5 shadow-sm ml-4` (ml-4 for step badge space). Wrap list in a `space-y-6` div.

**Critical rules:**
- NO `toLocaleDateString()` or `toLocaleString()` anywhere
- Use `.toFixed(1)` for all number formatting
- All computations derived from props, no server calls
  </action>
  <verify>`cd /home/dev/projects/relay && npx tsc --noEmit --project apps/web/tsconfig.json 2>&1 | head -30` passes. Then start dev server and verify page loads at `http://localhost:2002/my-leverage/deployment-plan`.</verify>
  <done>Dashboard displays KPI summary, cumulative FTE chart, and ranked adoption list with "Start Here" on first skill.</done>
</task>

</tasks>

<verification>
1. `cd /home/dev/projects/relay && npx tsc --noEmit --project apps/web/tsconfig.json` -- no errors
2. Dev server: page at `/my-leverage/deployment-plan` loads without errors
3. If user has recommendations: ranked list appears with step numbers, chart renders, KPIs display
4. If no recommendations: clean empty state with link to /my-leverage
</verification>

<success_criteria>
- Deployment plan page renders at /my-leverage/deployment-plan
- AreaChart shows cumulative FTE Days Saved over 12-week horizon
- Skills ranked by projectedWeeklySavings descending with step numbers
- First skill marked with "Start Here" callout
- KPI cards show total weekly savings, 12-week FTE projection, and skill count
- Empty state handles missing recommendations gracefully
</success_criteria>

<output>
After completion, create `.planning/phases/54-deployment-plan/54-01-SUMMARY.md`
</output>
