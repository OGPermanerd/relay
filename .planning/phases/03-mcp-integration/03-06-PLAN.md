---
phase: 03-mcp-integration
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/db/src/seed.ts
autonomous: false
gap_closure: true

must_haves:
  truths:
    - "Database has skills and usageEvents tables"
    - "Test skills exist in database for MCP tool testing"
    - "Seed script can be run to populate initial data"
  artifacts:
    - path: "packages/db/src/seed.ts"
      provides: "Database seeding script"
      min_lines: 30
  key_links:
    - from: "packages/db/src/seed.ts"
      to: "packages/db/src/schema/skills.ts"
      via: "import skills table"
      pattern: "import.*skills"
---

<objective>
Create database seed script and verify database is properly set up with test data.

Purpose: Close verification gap - skills schema exists but database may not have the tables created or test skills populated.

Output: Seed script that populates test skills, human verification that database is ready.
</objective>

<execution_context>
@/home/claude/.claude/get-shit-done/workflows/execute-plan.md
@/home/claude/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-mcp-integration/03-VERIFICATION.md
@packages/db/src/schema/skills.ts
@packages/db/src/schema/usage-events.ts
@packages/db/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create database seed script</name>
  <files>packages/db/src/seed.ts</files>
  <action>
Create a seed script that:

1. Imports the database client and skills schema
2. Defines 3 test skills per Plan 03-01 specification:
   - "Code Review Assistant" (category: development, hoursSaved: 2)
   - "API Documentation Generator" (category: documentation, hoursSaved: 4)
   - "Test Writer" (category: testing, hoursSaved: 3)
3. Uses upsert pattern to avoid duplicates on re-runs (conflict on slug)
4. Logs success/failure messages

Skill content should be placeholder markdown that demonstrates the format:
```markdown
# {Skill Name}

{Brief description}

## Usage

{How to use this skill}
```

Use proper slugs: code-review-assistant, api-documentation-generator, test-writer

Handle missing DATABASE_URL gracefully with clear error message.

Add npm script "db:seed" to packages/db/package.json that runs: tsx src/seed.ts
  </action>
  <verify>
- File exists at packages/db/src/seed.ts
- packages/db/package.json has "db:seed" script
- `pnpm --filter @relay/db typecheck` passes
  </verify>
  <done>Seed script creates 3 test skills with upsert pattern</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 2: Execute database setup (requires Docker)</name>
  <action>
This task requires human execution because Docker is not available in the sandbox environment.

**When Docker is available, run these commands:**

1. Start PostgreSQL container:
```bash
docker compose up -d
```

2. Push database schema:
```bash
pnpm --filter @relay/db db:push
```
(Accept the interactive confirmation for schema changes)

3. Run seed script:
```bash
pnpm --filter @relay/db db:seed
```

4. Verify tables and data:
```bash
# Connect to database and verify
docker exec -it relay-postgres psql -U postgres -d relay -c "SELECT name, slug, category FROM skills;"
```

Expected output: 3 rows with Code Review Assistant, API Documentation Generator, Test Writer
  </action>
  <how-to-verify>
1. Run docker compose up -d (PostgreSQL starts)
2. Run pnpm --filter @relay/db db:push (tables created)
3. Run pnpm --filter @relay/db db:seed (3 skills inserted)
4. Query skills table shows 3 rows
  </how-to-verify>
  <resume-signal>Type "database ready" when all steps complete, or describe any errors</resume-signal>
</task>

</tasks>

<verification>
1. `cat packages/db/src/seed.ts | wc -l` - At least 30 lines
2. `grep "db:seed" packages/db/package.json` - Script exists
3. Human confirms: `docker exec relay-postgres psql -U postgres -d relay -c "SELECT count(*) FROM skills;"` returns 3
</verification>

<success_criteria>
- Seed script exists and typechecks
- Database has skills and usage_events tables (human verified)
- 3 test skills exist in database (human verified)
- MCP tools can now return real data when invoked
</success_criteria>

<output>
After completion, create `.planning/phases/03-mcp-integration/03-06-SUMMARY.md`
</output>
