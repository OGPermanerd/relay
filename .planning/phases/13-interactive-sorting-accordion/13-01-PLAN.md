---
phase: 13-interactive-sorting-accordion
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/hooks/use-sort-state.ts
  - apps/web/components/sortable-column-header.tsx
autonomous: true

must_haves:
  truths:
    - "Sort state hook provides sortBy, sortDir, and toggleSort function"
    - "Sortable column header displays chevron indicator"
    - "Active sort column chevron is highlighted (blue)"
    - "Inactive sort columns show muted chevron"
  artifacts:
    - path: "apps/web/hooks/use-sort-state.ts"
      provides: "useSortState hook with nuqs URL state"
      exports: ["useSortState", "SORT_COLUMNS", "SortColumn", "SortDirection"]
    - path: "apps/web/components/sortable-column-header.tsx"
      provides: "Clickable th element with chevron indicator"
      exports: ["SortableColumnHeader"]
  key_links:
    - from: "apps/web/hooks/use-sort-state.ts"
      to: "nuqs"
      via: "useQueryState import"
      pattern: "useQueryState.*sortBy"
    - from: "apps/web/components/sortable-column-header.tsx"
      to: "useSortState return values"
      via: "props matching hook output"
      pattern: "currentSort|direction|onSort"
---

<objective>
Create the sorting infrastructure: URL state hook and sortable column header component

Purpose: Enable client-side column sorting with URL persistence for shareable sorted views (TABL-02, TABL-03, TABL-09)
Output: Reusable `useSortState` hook and `SortableColumnHeader` component ready for SkillsTable integration
</objective>

<execution_context>
@/home/claude/.claude/get-shit-done/workflows/execute-plan.md
@/home/claude/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-interactive-sorting-accordion/13-CONTEXT.md
@.planning/phases/13-interactive-sorting-accordion/13-RESEARCH.md
@apps/web/components/category-filter.tsx (nuqs pattern reference)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useSortState hook with nuqs URL state</name>
  <files>apps/web/hooks/use-sort-state.ts</files>
  <action>
Create the sorting state hook following established nuqs patterns from category-filter.tsx.

**Hook implementation:**
```typescript
"use client";

import { useQueryState, parseAsStringEnum, parseAsStringLiteral } from "nuqs";
import { useTransition } from "react";

export const SORT_COLUMNS = ["name", "days_saved", "installs", "date", "author"] as const;
export type SortColumn = (typeof SORT_COLUMNS)[number];

const SORT_DIRECTIONS = ["asc", "desc"] as const;
export type SortDirection = (typeof SORT_DIRECTIONS)[number];
```

**Hook behavior:**
- Default sortBy: "days_saved" (matches server default from 12-02)
- Default sortDir: "desc" (most useful first)
- toggleSort(column): If same column, toggle direction. If new column, set to "desc"
- Use `useTransition` for non-blocking updates (same pattern as CategoryFilter)
- Return: `{ sortBy, sortDir, isPending, toggleSort }`

**URL params:** `?sortBy=name&sortDir=asc`

**IMPORTANT:** Use `parseAsStringEnum` for sortBy (matches category-filter.tsx pattern). The cast pattern `SORT_COLUMNS as unknown as string[]` is the established pattern in this codebase.
  </action>
  <verify>
- TypeScript compiles: `cd apps/web && npx tsc --noEmit`
- Hook exports: grep for "export.*useSortState" and "export.*SortColumn"
  </verify>
  <done>
- useSortState hook exports useSortState, SORT_COLUMNS, SortColumn, SortDirection
- Hook provides sortBy, sortDir, isPending, toggleSort
- URL params "sortBy" and "sortDir" are used
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SortableColumnHeader component</name>
  <files>apps/web/components/sortable-column-header.tsx</files>
  <action>
Create the sortable column header component with chevron indicator.

**Component interface:**
```typescript
interface SortableColumnHeaderProps {
  column: SortColumn;
  label: string;
  currentSort: SortColumn;
  direction: SortDirection;
  onSort: (column: SortColumn) => void;
  align?: "left" | "right" | "center";
}
```

**Styling requirements (from CONTEXT.md):**
- Chevrons always visible on sortable column headers
- Active sort chevron: blue-600
- Inactive sort chevrons: gray-300
- Cursor pointer, hover:text-gray-700
- Match existing th styling from skills-table.tsx (px-4 py-3, text-xs font-medium uppercase tracking-wider)

**Chevron SVG (Heroicons style, matching codebase pattern):**
- Chevron down for desc: `<path strokeLinecap="round" strokeLinejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />`
- Chevron up for asc: `<path strokeLinecap="round" strokeLinejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />`

**Behavior:**
- Show chevron down when inactive OR when active+desc
- Show chevron up when active+asc
- onClick calls onSort(column)
- Wrap label + chevron in inline-flex for alignment
  </action>
  <verify>
- TypeScript compiles: `cd apps/web && npx tsc --noEmit`
- Component exports: grep for "export.*SortableColumnHeader"
- Contains both chevron paths (down and up)
  </verify>
  <done>
- SortableColumnHeader component exported
- Renders th element with label and chevron
- Chevron changes direction based on sort state
- Chevron color changes based on active state
  </done>
</task>

</tasks>

<verification>
After completing all tasks:
1. `cd apps/web && npx tsc --noEmit` passes
2. Both files exist and export expected symbols
3. useSortState hook uses nuqs with sortBy/sortDir URL params
4. SortableColumnHeader matches existing table header styling
</verification>

<success_criteria>
- Hook provides URL-synced sort state with toggleSort function
- Column header component displays chevron with correct direction/color
- All exports match expected interface for Plan 03 integration
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/13-interactive-sorting-accordion/13-01-SUMMARY.md`
</output>
