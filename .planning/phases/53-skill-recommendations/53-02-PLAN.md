---
phase: 53-skill-recommendations
plan: 02
type: execute
wave: 2
depends_on: ["53-01"]
files_modified:
  - apps/web/components/recommendation-card.tsx
  - apps/web/components/recommendations-section.tsx
  - apps/web/app/(protected)/my-leverage/page.tsx
autonomous: true

must_haves:
  truths:
    - "User sees personalized skill recommendations on my-leverage page after diagnostic scan"
    - "Each recommendation shows projected time savings and matched email categories"
    - "User can click through to skill detail page to install"
    - "Loading state displays while recommendations generate"
    - "Empty state shows when no recommendations found"
  artifacts:
    - path: "apps/web/components/recommendation-card.tsx"
      provides: "Single recommendation card with savings and install link"
      min_lines: 60
    - path: "apps/web/components/recommendations-section.tsx"
      provides: "Container for recommendations with loading/empty states"
      min_lines: 80
    - path: "apps/web/app/(protected)/my-leverage/page.tsx"
      provides: "Integration point for recommendations section"
      contains: "RecommendationsSection"
  key_links:
    - from: "apps/web/components/recommendations-section.tsx"
      to: "apps/web/app/actions/recommendations.ts"
      via: "getRecommendations action call"
      pattern: "getRecommendations\\("
    - from: "apps/web/components/recommendation-card.tsx"
      to: "/skills/[slug]"
      via: "Link to skill detail"
      pattern: "href=.*skills"
    - from: "apps/web/app/(protected)/my-leverage/page.tsx"
      to: "apps/web/components/recommendations-section.tsx"
      via: "RecommendationsSection component"
      pattern: "<RecommendationsSection"
---

<objective>
Create recommendation UI components and integrate into my-leverage page, enabling users to discover relevant skills based on their email diagnostic patterns.

Purpose: Display AI-generated skill recommendations with personalized reasoning and time savings, providing direct path to skill installation.

Output: Recommendation card component, recommendations section container with loading/empty states, and integration into my-leverage page.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/53-skill-recommendations/53-RESEARCH.md

# Previous plan
@.planning/phases/53-skill-recommendations/53-01-PLAN.md

# Existing UI patterns
@apps/web/components/skill-detail.tsx
@apps/web/app/(protected)/my-leverage/page.tsx
@apps/web/app/(protected)/my-leverage/email-diagnostic-card.tsx
@apps/web/lib/categories.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create recommendation card component</name>
  <files>apps/web/components/recommendation-card.tsx</files>
  <action>
Create `apps/web/components/recommendation-card.tsx` client component:

**Imports:**
```typescript
import Link from "next/link";
import { CATEGORY_LABELS, type Category } from "@/lib/categories";
import type { SkillRecommendation } from "@/lib/skill-recommendations";
```

**Props:**
```typescript
interface RecommendationCardProps {
  recommendation: SkillRecommendation;
}
```

**Layout structure:**
- Border card with hover effect (border-gray-200 → border-blue-400 on hover)
- Padding: p-4 or p-5
- Transition on hover: transition-colors

**Content sections:**

1. **Header row** (flex justify-between items-start):
   - Left: Skill name (text-lg font-semibold) + category badge (CATEGORY_LABELS from categories.ts, small uppercase badge)
   - Right: Projected savings (large number + "h" unit, blue-600 color) + "saved/week" label (text-xs gray-500)

2. **Description** (text-sm text-gray-700, mb-3):
   - Show recommendation.description (truncate if needed)

3. **Personalized reason callout** (bg-blue-50 border-l-4 border-blue-400 p-3 mb-3):
   - Icon: Light bulb or info icon
   - Text: recommendation.personalizedReason (text-sm text-blue-900)

4. **Footer row** (flex justify-between items-center):
   - Left: Metadata (text-sm text-gray-600, gap-3):
     - `{totalUses} uses`
     - If averageRating exists: `⭐ {(averageRating / 100).toFixed(1)}`
     - Matched categories count: `{matchedCategories.length} categories`
   - Right: Link button to skill detail page:
     - `<Link href={`/skills/${recommendation.slug}`}>` styled as button
     - Text: "View Skill" (not "Install" - that happens on detail page)
     - Style: bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700

**Styling:**
- Use existing Tailwind patterns from skill-detail.tsx
- Category badge: rounded-full bg-blue-100 px-3 py-1 text-sm uppercase text-blue-800
- Match color scheme with email-diagnostic-card.tsx for visual consistency

**Do NOT:**
- Include inline install modal (install flow is on skill detail page)
- Use client-side state (this is a pure display component)
  </action>
  <verify>
```bash
# Check file exists
test -f apps/web/components/recommendation-card.tsx && echo "FOUND"

# Check imports SkillRecommendation type
grep "SkillRecommendation" apps/web/components/recommendation-card.tsx

# Check links to skill detail
grep "/skills/" apps/web/components/recommendation-card.tsx

# TypeScript compiles
cd apps/web && npx tsc --noEmit --skipLibCheck
```
  </verify>
  <done>
- recommendation-card.tsx exists with RecommendationCard component
- Displays skill name, category badge, projected savings, description
- Shows personalized reason in blue callout box
- Links to /skills/[slug] detail page with "View Skill" button
- Shows metadata: uses, rating, matched categories count
- TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Create recommendations section container and integrate into my-leverage page</name>
  <files>
    apps/web/components/recommendations-section.tsx
    apps/web/app/(protected)/my-leverage/page.tsx
  </files>
  <action>
**Part A: Create apps/web/components/recommendations-section.tsx:**

Client component with "use client" directive.

**Imports:**
```typescript
"use client";
import { useEffect, useState } from "react";
import { getRecommendations } from "@/app/actions/recommendations";
import { RecommendationCard } from "./recommendation-card";
import type { SkillRecommendation } from "@/lib/skill-recommendations";
```

**State:**
```typescript
const [recommendations, setRecommendations] = useState<SkillRecommendation[] | null>(null);
const [error, setError] = useState<string | null>(null);
const [loading, setLoading] = useState(true);
```

**useEffect:** On mount, call getRecommendations() and update state

**Render logic:**

1. **Loading state** (loading === true):
   - Show 3 skeleton cards (animate-pulse, bg-gray-200, h-40 rounded-lg)
   - Text: "Analyzing your email patterns and finding relevant skills..."

2. **Error state** (error !== null):
   - Red/yellow callout box (bg-yellow-50 border-l-4 border-yellow-400 p-4)
   - Text: error message
   - If error is "No diagnostic scan found": Show additional text "Run an email diagnostic scan first to get recommendations."

3. **Empty state** (recommendations.length === 0):
   - Gray callout box (bg-gray-50 border border-gray-200 p-6 rounded-lg text-center)
   - Icon: Magnifying glass or lightbulb
   - Text: "No skill recommendations found yet. Your email patterns don't show clear automation opportunities, or our skill library doesn't have matches yet."
   - Subtext: "Run another diagnostic scan after your email patterns change."

4. **Success state** (recommendations.length > 0):
   - Section heading: "Recommended Skills" (text-xl font-semibold mb-4)
   - Subtext: "Based on your email patterns, these skills could save you time"
   - Grid of recommendation cards (grid grid-cols-1 lg:grid-cols-2 gap-4)
   - Map recommendations to RecommendationCard components

**Container styling:**
- Section wrapper: mb-8 or similar spacing to separate from other sections
- Match visual hierarchy with EmailDiagnosticCard

**Part B: Integrate into apps/web/app/(protected)/my-leverage/page.tsx:**

1. Import RecommendationsSection:
   ```typescript
   import { RecommendationsSection } from "@/components/recommendations-section";
   ```

2. Add after EmailDiagnosticCard section:
   ```typescript
   {/* Email Diagnostic Card */}
   <div className="mb-8">
     <EmailDiagnosticCard />
   </div>

   {/* Skill Recommendations */}
   <div className="mb-8">
     <RecommendationsSection />
   </div>
   ```

3. No props needed (RecommendationsSection fetches own data)

**Do NOT:**
- Add server-side data fetching to page.tsx (recommendations load client-side to avoid blocking page render)
- Create separate /recommendations route (keep on my-leverage page)
  </action>
  <verify>
```bash
# Check recommendations-section exists with "use client"
head -5 apps/web/components/recommendations-section.tsx | grep "use client"

# Check imports getRecommendations action
grep "getRecommendations" apps/web/components/recommendations-section.tsx

# Check my-leverage page imports RecommendationsSection
grep "RecommendationsSection" apps/web/app/\(protected\)/my-leverage/page.tsx

# TypeScript compiles
cd apps/web && npx tsc --noEmit --skipLibCheck

# Start dev server and verify page loads
cd apps/web && timeout 10 npm run dev > /dev/null 2>&1 &
sleep 5
curl -s http://localhost:2002/my-leverage | grep -q "My Leverage" && echo "Page loads"
pkill -f "next-server"
```
  </verify>
  <done>
- recommendations-section.tsx exists with "use client" directive
- Component manages loading, error, empty, and success states
- Calls getRecommendations action on mount via useEffect
- Shows skeleton loading for 3 cards during fetch
- Displays error message if diagnostic missing or AI fails
- Shows empty state if no recommendations found
- Renders grid of RecommendationCard components on success
- my-leverage page imports and renders RecommendationsSection after EmailDiagnosticCard
- Dev server starts and my-leverage page loads without errors
- TypeScript compiles without errors
  </done>
</task>

</tasks>

<verification>
1. RecommendationCard displays skill with projected savings and personalized reason
2. RecommendationsSection handles loading/error/empty/success states
3. Integration on my-leverage page shows recommendations after email diagnostic
4. Links navigate to skill detail page for install flow
5. Page loads without errors
</verification>

<success_criteria>
- Recommendation card shows skill name, category, projected savings, description, personalized reason, and metadata
- View Skill button links to /skills/[slug] detail page
- Recommendations section loads recommendations client-side and shows appropriate states
- Loading state displays skeleton cards with helpful text
- Error state shows diagnostic missing message with guidance
- Empty state explains when no recommendations found
- Success state displays grid of recommendations
- my-leverage page integrates recommendations section after diagnostic card
- Page loads without hydration errors or console warnings
</success_criteria>

<output>
After completion, create `.planning/phases/53-skill-recommendations/53-02-SUMMARY.md`
</output>
