---
phase: 10-quality-scorecards
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - apps/web/components/quality-badge.tsx
  - apps/web/components/skill-card.tsx
  - apps/web/lib/search-skills.ts
autonomous: true

must_haves:
  truths:
    - "Skill cards display quality badge in top-right corner"
    - "Badge shows correct tier color and label"
    - "Unrated skills show gray 'Unrated' badge"
  artifacts:
    - path: "apps/web/components/quality-badge.tsx"
      provides: "Reusable quality badge component"
      exports: ["QualityBadge"]
    - path: "apps/web/components/skill-card.tsx"
      provides: "Skill card with badge integration"
      contains: "QualityBadge"
  key_links:
    - from: "apps/web/components/quality-badge.tsx"
      to: "apps/web/lib/quality-score.ts"
      via: "imports tier types and colors"
      pattern: "import.*QUALITY_TIERS|QualityTier"
    - from: "apps/web/components/skill-card.tsx"
      to: "apps/web/components/quality-badge.tsx"
      via: "renders badge component"
      pattern: "<QualityBadge"
---

<objective>
Create QualityBadge component and integrate into SkillCard.

Purpose: Users see quality badges on browse/search results to quickly identify high-quality skills.
Output: Badge component and updated skill cards with badge display.
</objective>

<execution_context>
@/home/claude/.claude/get-shit-done/workflows/execute-plan.md
@/home/claude/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/10-quality-scorecards/10-CONTEXT.md
@apps/web/components/skill-card.tsx
@apps/web/lib/quality-score.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create QualityBadge component</name>
  <files>apps/web/components/quality-badge.tsx</files>
  <action>
Create a QualityBadge component that displays tier badges.

Props:
- tier: QualityTier (from quality-score.ts)
- size?: "sm" | "md" (default "sm" for cards, "md" for detail page)

Styling from CONTEXT.md:
- Gold: #FFD700 background, dark text
- Silver: #C0C0C0 background, dark text
- Bronze: #CD7F32 background, white text
- Unrated: gray-200 background, gray-600 text
- None tier: return null (no badge displayed)

Structure:
- Small rounded pill/badge shape
- Capitalize tier name as label (e.g., "Gold", "Silver", "Unrated")
- Use Tailwind for styling, custom hex colors via style prop or Tailwind arbitrary values

For size="sm": text-xs, px-2 py-0.5
For size="md": text-sm, px-3 py-1
  </action>
  <verify>Component renders correctly with `npm run build` passing</verify>
  <done>QualityBadge component exists and exports correctly</done>
</task>

<task type="auto">
  <name>Task 2: Extend SkillCardData and search to include rating count</name>
  <files>apps/web/lib/search-skills.ts, apps/web/components/skill-card.tsx</files>
  <action>
The quality score calculation needs totalRatings, which isn't currently in SearchSkillResult.

1. In search-skills.ts:
   - Add a subquery or join to count ratings per skill
   - Add `totalRatings: number` to SearchSkillResult interface
   - Modify the select to include: `sql<number>\`(SELECT count(*) FROM ratings WHERE skill_id = skills.id)\`.as('totalRatings')`

2. In skill-card.tsx:
   - Add `totalRatings: number` to SkillCardData interface

Note: This is a computed scalar subquery, efficient for listing pages with typical result sizes (<100 skills).
  </action>
  <verify>`npm run build` passes and search returns totalRatings field</verify>
  <done>SearchSkillResult and SkillCardData include totalRatings</done>
</task>

<task type="auto">
  <name>Task 3: Integrate QualityBadge into SkillCard</name>
  <files>apps/web/components/skill-card.tsx</files>
  <action>
Add quality badge to skill cards.

1. Import calculateQualityScore from quality-score.ts
2. Import QualityBadge component
3. Inside SkillCard, compute the tier:
   ```typescript
   const { tier } = calculateQualityScore({
     totalUses: skill.totalUses,
     averageRating: skill.averageRating,
     totalRatings: skill.totalRatings,
     hasDescription: Boolean(skill.description),
     hasCategory: Boolean(skill.category),
   });
   ```
4. Render badge in top-right corner of card header:
   - Use absolute positioning within a relative container
   - Place after the category span, before the h3
   - Position: `absolute top-0 right-0` (parent needs `relative`)

Structure adjustment:
```tsx
<div className="relative mb-3">
  <span className="text-xs...">{skill.category}</span>
  <div className="absolute top-0 right-0">
    <QualityBadge tier={tier} size="sm" />
  </div>
  <h3>...</h3>
  <p>...</p>
</div>
```
  </action>
  <verify>Run dev server, navigate to /skills, verify badges appear on skill cards</verify>
  <done>Skill cards display quality badges in top-right corner with correct tier colors</done>
</task>

</tasks>

<verification>
1. `npm run build` passes without type errors
2. Browse /skills page shows badges on skill cards
3. Different skills show different tier badges based on their metrics
4. Skills with <3 ratings show "Unrated" gray badge
5. Skills with score <25 show no badge (tier "none")
</verification>

<success_criteria>
- QualityBadge component is reusable with size prop
- Skill cards show correct tier badges
- Badge positioning doesn't break card layout
- Unrated and no-badge states handled correctly
</success_criteria>

<output>
After completion, create `.planning/phases/10-quality-scorecards/10-02-SUMMARY.md`
</output>
