---
phase: 10-quality-scorecards
plan: 01
type: tdd
wave: 1
depends_on: []
files_modified:
  - apps/web/lib/quality-score.ts
  - apps/web/lib/__tests__/quality-score.test.ts
autonomous: true

must_haves:
  truths:
    - "Quality score is calculated from usage, rating, and documentation"
    - "Skills with <3 ratings return 'unrated' tier"
    - "Score maps to correct tier (Gold/Silver/Bronze/None)"
  artifacts:
    - path: "apps/web/lib/quality-score.ts"
      provides: "calculateQualityScore and getQualityTier functions"
      exports: ["calculateQualityScore", "getQualityTier", "QualityTier", "QUALITY_TIERS"]
    - path: "apps/web/lib/__tests__/quality-score.test.ts"
      provides: "Test coverage for scoring logic"
      min_lines: 50
  key_links:
    - from: "apps/web/lib/quality-score.ts"
      to: "scoring formula"
      via: "weighted calculation"
      pattern: "usage.*0\\.5|rating.*0\\.35|docs.*0\\.15"
---

<objective>
Implement quality score calculation with TDD to ensure correct tier assignment.

Purpose: Quality scores are the foundation of the scorecard feature. Correct calculation prevents misleading badges and ensures user trust.
Output: Tested utility functions for score calculation and tier assignment.
</objective>

<execution_context>
@/home/claude/.claude/get-shit-done/workflows/execute-plan.md
@/home/claude/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/10-quality-scorecards/10-CONTEXT.md
@apps/web/lib/skill-stats.ts
</context>

<feature>
  <name>Quality Score Calculation</name>
  <files>apps/web/lib/quality-score.ts, apps/web/lib/__tests__/quality-score.test.ts</files>
  <behavior>
    calculateQualityScore(input: QualityScoreInput) -> { score: number, tier: QualityTier, breakdown: QualityBreakdown }

    Input shape:
    - totalUses: number
    - averageRating: number | null (stored as rating*100, e.g., 425 = 4.25)
    - totalRatings: number
    - hasDescription: boolean
    - hasCategory: boolean

    Score formula (0-100 normalized):
    - Usage component (50%): min(totalUses / 100, 1) * 50
    - Rating component (35%): (averageRating / 500) * 35 (if >= 3 ratings, else 0)
    - Docs component (15%): (hasDescription && hasCategory) ? 15 : 0

    Tier assignment:
    - totalRatings < 3 -> "unrated"
    - score >= 75 -> "gold"
    - score >= 50 -> "silver"
    - score >= 25 -> "bronze"
    - score < 25 -> "none"

    Test cases:
    - { totalUses: 0, averageRating: null, totalRatings: 0, hasDescription: true, hasCategory: true } -> tier: "unrated"
    - { totalUses: 100, averageRating: 500, totalRatings: 5, hasDescription: true, hasCategory: true } -> score: 100, tier: "gold"
    - { totalUses: 50, averageRating: 350, totalRatings: 3, hasDescription: true, hasCategory: true } -> score: ~64, tier: "silver"
    - { totalUses: 10, averageRating: 200, totalRatings: 3, hasDescription: false, hasCategory: true } -> tier: "bronze" or "none"
    - { totalUses: 200, averageRating: 250, totalRatings: 10, hasDescription: true, hasCategory: true } -> score includes usage cap at 50
  </behavior>
  <implementation>
    1. Export QualityTier type: "gold" | "silver" | "bronze" | "none" | "unrated"
    2. Export QUALITY_TIERS constant with threshold and color info for each tier
    3. Export QualityScoreInput interface
    4. Export QualityBreakdown interface { usageScore: number, ratingScore: number, docsScore: number }
    5. Export calculateQualityScore function implementing formula
    6. Export getQualityTier convenience function that returns just the tier
  </implementation>
</feature>

<verification>
Run tests with: `cd apps/web && npm test -- quality-score`
All test cases must pass before marking complete.
</verification>

<success_criteria>
- Tests exist covering: unrated threshold, all tier boundaries, usage cap, null rating handling
- calculateQualityScore returns correct score and breakdown for test inputs
- getQualityTier returns correct tier string
- Type exports work correctly (verify with `tsc --noEmit`)
</success_criteria>

<output>
After completion, create `.planning/phases/10-quality-scorecards/10-01-SUMMARY.md`
</output>
