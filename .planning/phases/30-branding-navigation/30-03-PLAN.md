---
phase: 30-branding-navigation
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/lib/contributor-tier.ts
  - apps/web/components/greeting-area.tsx
autonomous: true

must_haves:
  truths:
    - "getContributorTier returns Platinum/Gold/Silver/Bronze based on composite score"
    - "GreetingArea displays user name, personal days saved, and contributor tier"
    - "Tier computation uses skillsShared, daysSaved, avgRating, and totalUses"
  artifacts:
    - path: "apps/web/lib/contributor-tier.ts"
      provides: "Contributor tier computation logic"
      exports: ["getContributorTier", "ContributorTier"]
    - path: "apps/web/components/greeting-area.tsx"
      provides: "GreetingArea server component"
      exports: ["GreetingArea"]
  key_links:
    - from: "apps/web/components/greeting-area.tsx"
      to: "apps/web/lib/contributor-tier.ts"
      via: "import getContributorTier"
      pattern: "getContributorTier"
    - from: "apps/web/components/greeting-area.tsx"
      to: "apps/web/lib/user-stats.ts"
      via: "import getUserStats"
      pattern: "getUserStats"
---

<objective>
Create contributor tier computation and greeting area component.

Purpose: BRAND-08 requires composite contributor tiers (Platinum/Gold/Silver/Bronze). BRAND-07 requires a greeting area showing "Name -- XX Days Saved | Tier Contributor".
Output: `getContributorTier()` pure function + `GreetingArea` server component.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@apps/web/lib/user-stats.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create contributor tier computation</name>
  <files>apps/web/lib/contributor-tier.ts</files>
  <action>
Create `apps/web/lib/contributor-tier.ts`:

```typescript
export type ContributorTier = "Platinum" | "Gold" | "Silver" | "Bronze";

interface TierInput {
  skillsShared: number;
  daysSaved: number;
  avgRating: number | null;
  totalUses: number;
}

const TIER_THRESHOLDS = {
  Platinum: 75,
  Gold: 50,
  Silver: 25,
  Bronze: 0,
} as const;

export function getContributorTier(input: TierInput): ContributorTier {
  // Normalize each metric to 0-25 points (max 100 total)
  const skillsScore = Math.min(input.skillsShared * 5, 25);
  const daysScore = Math.min(input.daysSaved * 2, 25);
  const ratingScore = input.avgRating !== null ? (input.avgRating / 5) * 25 : 0;
  const usageScore = Math.min(input.totalUses * 0.5, 25);

  const total = skillsScore + daysScore + ratingScore + usageScore;

  if (total >= TIER_THRESHOLDS.Platinum) return "Platinum";
  if (total >= TIER_THRESHOLDS.Gold) return "Gold";
  if (total >= TIER_THRESHOLDS.Silver) return "Silver";
  return "Bronze";
}
```

Also export a `TIER_COLORS` map for display:
```typescript
export const TIER_COLORS: Record<ContributorTier, string> = {
  Platinum: "text-purple-600",
  Gold: "text-yellow-600",
  Silver: "text-gray-500",
  Bronze: "text-orange-700",
};
```
  </action>
  <verify>Run `cd /home/dev/projects/relay && npx tsc --noEmit -p apps/web/tsconfig.json 2>&1 | head -20`.</verify>
  <done>getContributorTier function exists, takes {skillsShared, daysSaved, avgRating, totalUses} and returns one of Platinum/Gold/Silver/Bronze. TIER_COLORS exported for display.</done>
</task>

<task type="auto">
  <name>Task 2: Create GreetingArea server component</name>
  <files>apps/web/components/greeting-area.tsx</files>
  <action>
Create `apps/web/components/greeting-area.tsx` as a SERVER component (no "use client"):

```typescript
import { getUserStats } from "@/lib/user-stats";
import { getContributorTier, TIER_COLORS } from "@/lib/contributor-tier";

interface GreetingAreaProps {
  userId: string;
  userName: string;
}

export async function GreetingArea({ userId, userName }: GreetingAreaProps) {
  const stats = await getUserStats(userId);
  const tier = getContributorTier({
    skillsShared: stats.skillsShared,
    daysSaved: stats.fteDaysSaved,
    avgRating: stats.avgRating !== null ? parseFloat(stats.avgRating) : null,
    totalUses: stats.totalUses,
  });

  const displayDays = Math.round(stats.fteDaysSaved);

  return (
    <div className="hidden items-center gap-1.5 text-sm sm:flex">
      <span className="font-medium text-gray-700">{userName}</span>
      <span className="text-gray-400">&mdash;</span>
      <span className="font-semibold text-gray-900">
        {displayDays} {displayDays === 1 ? "Day" : "Days"} Saved
      </span>
      <span className="text-gray-300">|</span>
      <span className={`font-semibold ${TIER_COLORS[tier]}`}>
        {tier} Contributor
      </span>
    </div>
  );
}
```

Key decisions:
- Server component (async function) so getUserStats() runs server-side with no client bundle cost.
- Hidden on mobile (`hidden sm:flex`) to avoid crowding small screens.
- Uses `&mdash;` (em dash) between name and stats per BRAND-07 spec.
- parseFloat on avgRating since getUserStats returns it as string.
- Do NOT use `toLocaleString()` (hydration issues per MEMORY.md -- though this is a server component, maintain consistency).
  </action>
  <verify>Run `cd /home/dev/projects/relay && npx tsc --noEmit -p apps/web/tsconfig.json 2>&1 | head -20`.</verify>
  <done>GreetingArea server component exists, displays "Name -- XX Days Saved | Tier Contributor" with color-coded tier.</done>
</task>

</tasks>

<verification>
- `apps/web/lib/contributor-tier.ts` exports `getContributorTier`, `ContributorTier`, `TIER_COLORS`.
- `apps/web/components/greeting-area.tsx` exports `GreetingArea` (async server component).
- GreetingArea imports from both `user-stats.ts` and `contributor-tier.ts`.
- TypeScript compiles without errors.
</verification>

<success_criteria>
Contributor tier logic correctly scores users across 4 axes (skills, days, ratings, usage) and maps to Platinum/Gold/Silver/Bronze. GreetingArea displays personalized stats in a compact inline format.
</success_criteria>

<output>
After completion, create `.planning/phases/30-branding-navigation/30-03-SUMMARY.md`
</output>
