---
phase: 30-branding-navigation
plan: 04
type: execute
wave: 2
depends_on: ["30-01"]
files_modified:
  - apps/web/components/tenant-branding.tsx
autonomous: true

must_haves:
  truths:
    - "Freemium tenants see 'TenantName x EverySkill' with animated logo (small)"
    - "Paid tenants with a logo see only their tenant logo"
    - "No subdomain or unknown tenant shows the default AnimatedLogo"
  artifacts:
    - path: "apps/web/components/tenant-branding.tsx"
      provides: "TenantBranding server component"
      exports: ["TenantBranding"]
  key_links:
    - from: "apps/web/components/tenant-branding.tsx"
      to: "apps/web/components/animated-logo.tsx"
      via: "import AnimatedLogo"
      pattern: "AnimatedLogo"
    - from: "apps/web/components/tenant-branding.tsx"
      to: "@everyskill/db/services/tenant"
      via: "getTenantBySlug"
      pattern: "getTenantBySlug"
---

<objective>
Create a tenant-aware branding component that conditionally renders logos based on tenant plan.

Purpose: BRAND-02 requires white-label branding. Freemium tenants display "TenantName x EverySkill", paid tenants show only their own logo.
Output: `TenantBranding` server component.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@packages/db/src/services/tenant.ts
@packages/db/src/schema/tenants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TenantBranding server component</name>
  <files>apps/web/components/tenant-branding.tsx</files>
  <action>
Create `apps/web/components/tenant-branding.tsx` as a SERVER component (no "use client"):

```typescript
import { headers } from "next/headers";
import { getTenantBySlug } from "@everyskill/db/services/tenant";
import { AnimatedLogo } from "@/components/animated-logo";

export async function TenantBranding() {
  const headerList = await headers();
  const slug = headerList.get("x-tenant-slug");

  // No subdomain = show default EverySkill logo
  if (!slug) {
    return <AnimatedLogo />;
  }

  const tenant = await getTenantBySlug(slug);
  if (!tenant) {
    return <AnimatedLogo />;
  }

  // Paid tenant with logo: show tenant logo only
  if (tenant.plan === "paid" && tenant.logo) {
    return (
      <img
        src={tenant.logo}
        alt={tenant.name}
        className="h-8 max-w-[140px] object-contain"
      />
    );
  }

  // Freemium: "TenantName x EverySkill"
  return (
    <div className="flex items-center gap-2">
      {tenant.logo && (
        <img
          src={tenant.logo}
          alt={tenant.name}
          className="h-6 w-6 rounded object-contain"
        />
      )}
      <span className="text-sm font-semibold text-gray-700">{tenant.name}</span>
      <span className="text-xs text-gray-400">x</span>
      <AnimatedLogo size="small" />
    </div>
  );
}
```

Key decisions:
- Use plain `<img>` tag for tenant logos instead of `next/image`. Reason: tenant logo URLs come from arbitrary domains. Using next/image would require adding every possible domain to `remotePatterns` in next.config.ts. Plain img avoids this entirely. Per research open question #2: "accept arbitrary URLs and use <img> tag".
- Do NOT add any domains to next.config.ts remotePatterns for tenant logos.
- Server component (async) to read headers and fetch tenant data server-side.
- Falls back to default AnimatedLogo when no subdomain or unknown tenant.
  </action>
  <verify>Run `cd /home/dev/projects/relay && npx tsc --noEmit -p apps/web/tsconfig.json 2>&1 | head -20`.</verify>
  <done>
TenantBranding server component exists. It reads x-tenant-slug header, fetches tenant from DB, and renders: (1) AnimatedLogo for no tenant, (2) tenant-only logo for paid tenants, (3) "TenantName x EverySkill" for freemium tenants.
  </done>
</task>

</tasks>

<verification>
- `apps/web/components/tenant-branding.tsx` exports `TenantBranding`.
- Component imports `AnimatedLogo` from 30-01 output.
- Component imports `getTenantBySlug` from `@everyskill/db/services/tenant`.
- Uses `await headers()` (async pattern per Next.js 15+).
- TypeScript compiles without errors.
</verification>

<success_criteria>
TenantBranding correctly renders three branding variants based on tenant plan and logo availability. No new npm dependencies or next.config.ts changes needed.
</success_criteria>

<output>
After completion, create `.planning/phases/30-branding-navigation/30-04-SUMMARY.md`
</output>
