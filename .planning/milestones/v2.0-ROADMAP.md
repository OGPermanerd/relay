# Milestone v2.0: Skill Ecosystem

**Status:** SHIPPED 2026-02-08
**Phases:** 34-39
**Total Plans:** 23

## Overview

Transform skill publishing from instant-publish to a quality-gated pipeline with AI review, author revision, and admin approval -- plus conversational discovery via MCP and fork-on-modify detection. 44 requirements across 6 categories.

## Phases

### Phase 34: Review Pipeline Foundation

**Goal**: Skills enter a gated lifecycle instead of auto-publishing -- authors create drafts, submit for review, and only published skills appear in search/browse
**Depends on**: Nothing (first phase of v2.0)
**Requirements**: RVPL-01, RVPL-02, RVPL-05, RVPL-06, RVPL-07, RVPL-08, RVPL-09, RVPL-10, RVPL-12
**Plans**: 5 plans

Plans:
- [x] 34-01: Schema + state machine + migration
- [x] 34-02: Creation paths set status='draft'
- [x] 34-03: Query guards (18 public query paths)
- [x] 34-04: Access control, My Skills badges, submit-for-review
- [x] 34-05: Build verification and E2E tests

### Phase 35: AI Review Integration

**Goal**: Submitting a skill for review automatically triggers AI analysis with explicit error handling, and authors/admins can trigger and check reviews via MCP
**Depends on**: Phase 34
**Requirements**: RVPL-03, RVPL-04, RVPL-11, MCPR-01, MCPR-02, MCPR-03
**Plans**: 3 plans

Plans:
- [x] 35-01: Schema statusMessage column + auto-approve threshold logic
- [x] 35-02: Submit-for-review pipeline with inline AI review + error UI
- [x] 35-03: MCP tools (review_skill, submit_for_review, check_review_status)

### Phase 36: Admin Review UI

**Goal**: Tenant admins can efficiently review submitted skills with full context (AI scores, content diff) and take approve/reject/request-changes actions
**Depends on**: Phase 34, Phase 35
**Requirements**: ADMR-01, ADMR-02, ADMR-03, ADMR-04, ADMR-05, ADMR-06, ADMR-07, ADMR-08, ADMR-09
**Plans**: 3 plans

Plans:
- [x] 36-01: Review decisions schema, migration, service, and query functions
- [x] 36-02: Server actions, review queue page, and admin nav badge
- [x] 36-03: Review detail page with AI scores, diff view, and action forms

### Phase 37: Review Notifications

**Goal**: Authors and admins receive timely in-app and email notifications at every stage of the review lifecycle
**Depends on**: Phase 34, Phase 35
**Requirements**: RVNT-01, RVNT-02, RVNT-03, RVNT-04, RVNT-05, RVNT-06, RVNT-07
**Plans**: 4 plans

Plans:
- [x] 37-01: Schema, migration, type union, getAdminsInTenant, preference service
- [x] 37-02: Email template and notifyReviewEvent dispatch function
- [x] 37-03: Wiring dispatch into submit-for-review and admin-reviews actions
- [x] 37-04: Preferences form UI and notification bell icons

### Phase 38: Conversational MCP Discovery

**Goal**: Users can discover skills through natural conversation in Claude -- semantic search, detailed descriptions, and post-install guidance
**Depends on**: Nothing (independent of review pipeline; uses existing embedding infrastructure)
**Requirements**: DISC-01, DISC-02, DISC-03, DISC-04, DISC-05, DISC-06
**Plans**: 4 plans

Plans:
- [x] 38-01: Semantic search service + Ollama client for MCP
- [x] 38-02: recommend_skills MCP tool with semantic search + ILIKE fallback
- [x] 38-03: describe_skill + guide_skill MCP tools
- [x] 38-04: Enhanced search_skills with rating/usage/tier metadata

### Phase 39: Fork Detection

**Goal**: Users know when their local skill copy has diverged from the published version and can push changes back or create forks
**Depends on**: Nothing (independent of review pipeline; uses existing fork and contentHash infrastructure)
**Requirements**: FORK-01, FORK-02, FORK-03, FORK-04, FORK-05, FORK-06, FORK-07
**Plans**: 4 plans

Plans:
- [x] 39-01: Schema migration + fork action update (forkedAtContentHash, skill_versions)
- [x] 39-02: check_skill_status MCP tool with frontmatter-stripping hash comparison
- [x] 39-03: update_skill MCP tool (author-update or non-author-fork)
- [x] 39-04: Web UI drift indicator + side-by-side comparison page

---

## Milestone Summary

**Key Decisions:**
- Status column DEFAULT 'published' for backward compat; state machine is pure function service
- AI review awaited inline (not fire-and-forget) -- user sees result immediately
- Auto-approve threshold defaults to 7/10 -- all 3 categories must meet threshold
- review_decisions table is insert-only for SOC2 immutable audit trail
- All notification dispatch happens AFTER DB transactions, never inside them
- cosineDistance from drizzle-orm for type-safe pgvector queries
- MCP Ollama client is self-contained (no cross-app imports) for stdio protocol safety
- forkedAtContentHash computed from stripped body (no frontmatter) for accurate drift detection

**Issues Resolved:**
- Drizzle-kit push prompts about unrelated constraints -- applied migrations via psql directly
- tsup DTS can't resolve @everyskill/db service exports -- duplicated state machine into MCP tools
- Review notification grouping under single preference toggle (not per-type)

**Technical Debt Incurred:**
- apps/mcp tsc --noEmit has pre-existing errors from packages/db module resolution
- DEFAULT_TENANT_ID hardcoded in 18+ files (future: dynamic tenant resolution)
- No backfill for existing forks' forkedAtContentHash (old forks show "unknown" drift status)

---

_For current project status, see .planning/ROADMAP.md_
