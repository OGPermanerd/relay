# Milestone v6.0: IP Dashboard & Skills Portfolio

**Status:** SHIPPED 2026-02-16
**Phases:** 62-68
**Total Plans:** 15

## Overview

Make the IP stewardship value proposition tangible — give companies an IP dashboard showing what they've captured and what's at risk, and give individuals a skills portfolio showing their contributions and portable IP.

## Phases

### Phase 62: Company IP Dashboard Core

**Goal**: Admins can see a company-wide IP dashboard with total skills captured, usage, hours saved, active contributors, and quality trends over time
**Depends on**: Nothing (builds on existing data in skills, usage_events, ratings, skill_feedback, token_measurements tables)
**Plans**: 2 plans

Plans:
- [x] 62-01: Query module (hero stats + quality trends SQL) and nav tab
- [x] 62-02: IP dashboard page, stat cards view, and quality trend chart

**Details:**
- Hero KPI stat cards: total skills, total uses, total hours saved, active contributors
- Org-wide quality trends chart (Recharts) with monthly granularity: average ratings, feedback sentiment, benchmark results
- Three-query-merge pattern for multi-series trend data
- Admin-only, tenant-scoped page under /leverage navigation

### Phase 63: IP Risk Analysis

**Goal**: Admins can identify IP concentration risks — which critical skills depend on a single author and would be lost if that person left
**Depends on**: Phase 62
**Plans**: 2 plans

Plans:
- [x] 63-01: Risk query functions, server action, and sort hook (data layer)
- [x] 63-02: IP Risk Section component and page wiring (UI layer)

**Details:**
- IP concentration risk ranking: employees ranked by how much critical IP they solely own
- Alert badges with amber/red severity indicators (HIGH_USAGE_THRESHOLD=10, CRITICAL_USAGE_THRESHOLD=50)
- Employee drill-down via server action showing per-employee at-risk skills
- nuqs-based sort state for risk table columns

### Phase 64: IP Valuation & Export

**Goal**: Admins can see estimated replacement cost for high-value skills and export a complete IP report for board presentations
**Depends on**: Phase 62, Phase 63
**Plans**: 2 plans

Plans:
- [x] 64-01: Replacement cost formula, SQL query, and server action (data layer)
- [x] 64-02: Hero stat, valuation table, PDF/CSV export buttons (UI layer)

**Details:**
- Replacement cost formula: base * complexity_multiplier * quality_multiplier (HOURLY_RATE=$150)
- Complexity: log10(contentLength/1000), clamped [1.0, 2.0]
- Quality: normalized from 0-500 to [0.5, 1.0]
- Total estimated IP value hero stat
- Top 20 skills by replacement cost in valuation table
- jsPDF dynamically imported for PDF export; CSV export includes all skills
- Parallel data fetching for export payloads

### Phase 65: Individual Skills Portfolio

**Goal**: Users can view their personal skills portfolio showing what they've built, how much impact it's had, and which skills are portable vs company-owned
**Depends on**: Nothing (independent of IP dashboard track)
**Plans**: 2 plans

Plans:
- [x] 65-01: Data layer — portfolio queries (stats, skills, ranking) + nav link
- [x] 65-02: UI layer — portfolio page, view component, and E2E test

**Details:**
- Portfolio stats with FILTER (WHERE) conditional aggregation for single-pass visibility breakdown
- Portable vs company IP: personal-scoped (green accent) vs tenant-scoped (blue accent) visual indicators
- PERCENT_RANK() with inverted percentile for "Top N%" labels; ordinal for small teams
- Portfolio NavLink in header navigation

### Phase 66: Impact Measurement

**Goal**: Users can see how their contributions have grown over time and quantify the total value they've added to the company
**Depends on**: Phase 65
**Plans**: 2 plans

Plans:
- [x] 66-01: Data layer + components — timeline/calculator queries and chart/calculator components
- [x] 66-02: Page wiring — integrate into portfolio page and E2E tests

**Details:**
- Impact timeline: UNION ALL combining creations, forks, suggestions with SUM() OVER window function for cumulative hours
- ComposedChart pattern: Area for continuous series + Scatter for categorical event markers (creation/fork/suggestion)
- Impact calculator: total hours saved, estimated cost equivalent, skills improved via forks/suggestions
- E2E tests with heading.or(emptyState) conditional assertion pattern

### Phase 67: Skills Resume

**Goal**: Users can generate a shareable, formatted summary of their skills and impact suitable for job applications and professional profiles
**Depends on**: Phase 65, Phase 66
**Plans**: 2 plans

Plans:
- [x] 67-01: Schema, data queries, server actions, and middleware exemption (data layer)
- [x] 67-02: Resume view, PDF download, share controls, public page, and E2E tests (UI layer)

**Details:**
- resume_shares table with token-based public access (revoke-and-replace pattern)
- Quality tier computation per-skill with Gold/Silver/Bronze badges
- includeCompanySkills toggle: personal-only vs all skills via search param
- Shared ResumeView component for both auth and public pages (isPublic prop)
- /r/ middleware exemption for public resume pages
- jsPDF for PDF download

### Phase 68: Pre-LLM History

**Goal**: Users can upload historical work artifacts to demonstrate impact from before they started using the platform
**Depends on**: Phase 65
**Plans**: 3 plans

Plans:
- [x] 68-01: Schema, migration, server actions, and portfolio query (data layer)
- [x] 68-02: Upload form, artifact list, portfolio integration, and timeline visualization (UI layer)
- [x] 68-03: AI skill analysis and E2E tests (intelligence + verification)

**Details:**
- work_artifacts table with RLS tenant isolation, 50-artifact limit per user
- Dynamic SET clause via sql.join for partial updates
- Client-side file parsing before server action (.txt/.md/.json/.eml, 5MB limit, 100K char truncation)
- Pre-Platform Work section in portfolio layout
- AI artifact analysis: Claude Haiku with json_schema output_config, fire-and-forget pattern
- Hallucinated skill ID prevention: filter AI results against catalog Set before DB write
- Self-cleaning E2E tests with Date.now() in titles for uniqueness

---

## Milestone Summary

**Key Decisions:**
- IP dashboard under /leverage (follows existing analytics pattern)
- Portfolio as new /portfolio route (not extension of /profile)
- No new schema for IPDASH phases (all SQL aggregation on existing tables)
- New schema only for PORT-06 (work_artifacts) and PORT-04 (resume_shares)
- Replacement cost formula: base * complexity * quality with clamped multipliers
- jsPDF dynamically imported for bundle size (PDF export on both IP dashboard and resume)
- ComposedChart for impact timeline (Area + Scatter for mixed event types)
- Token-based resume sharing with revoke-and-replace pattern
- Fire-and-forget AI analysis for uploaded artifacts (never blocks user)

**Issues Resolved:**
- Hydration-safe currency formatting (manual formatter instead of toLocaleString)
- Quality score normalization across different rating scales (0-500 → 0-1)
- Conditional aggregation for single-pass multi-visibility queries
- File parsing on client side to avoid serializing File objects to server actions

**Issues Deferred:**
- Portfolio PDF download (captured in backlog)
- OAuth re-link / user migration tool (captured in backlog)

**Technical Debt Incurred:**
- HOURLY_RATE=$150 hardcoded (should be configurable per tenant)
- Threshold constants (HIGH_USAGE=10, CRITICAL_USAGE=50) inlined in client component
- 50-artifact limit is a flat cap (should scale with plan tier)

---

_For current project status, see .planning/ROADMAP.md_
